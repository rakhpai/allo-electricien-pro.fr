{{ define "main" }}

{{/* Profile Hero Section */}}
<section class="relative bg-gradient-to-br from-blue-50 via-white to-gray-50 py-12 md:py-16">
  <div class="container mx-auto px-4">
    <div class="max-w-5xl mx-auto">

      {{/* Breadcrumb */}}
      {{/* Extract department from postal code (first 2 digits) */}}
      {{- $postalCode := .Params.address.postalCode | default "" -}}
      {{- $department := substr $postalCode 0 2 -}}
      {{/* Department name mapping for Île-de-France */}}
      {{- $deptNames := dict "75" "Paris" "77" "Seine-et-Marne" "78" "Yvelines" "91" "Essonne" "92" "Hauts-de-Seine" "93" "Seine-Saint-Denis" "94" "Val-de-Marne" "95" "Val-d'Oise" -}}
      {{- $deptName := index $deptNames $department -}}

      <nav class="mb-6 text-sm" aria-label="Breadcrumb">
        <ol class="flex items-center space-x-2 text-gray-600">
          <li><a href="/" class="hover:text-blue-600">Accueil</a></li>
          <li><span class="mx-2">›</span></li>
          <li><a href="/profiles/" class="hover:text-blue-600">Électriciens</a></li>
          {{- if and $department $deptName }}
          <li><span class="mx-2">›</span></li>
          <li><a href="/electricien/{{ $department }}/" class="hover:text-blue-600">{{ $deptName }} ({{ $department }})</a></li>
          {{- end }}
          <li><span class="mx-2">›</span></li>
          <li class="text-gray-900 font-medium">{{ .Params.first_name }} {{ .Params.last_name }}</li>
        </ol>
      </nav>

      {{/* Profile Card */}}
      <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
        <div class="md:flex">

          {{/* Image Column */}}
          <div class="md:w-2/5 relative">
            <div class="aspect-[4/3] md:aspect-auto md:h-full relative overflow-hidden">
              <picture>
                <source
                  media="(min-width: 768px)"
                  srcset="{{ .Params.images.landscape | default .Params.avatar_url }}"
                >
                <img
                  src="{{ .Params.images.square | default .Params.avatar_url }}"
                  alt="{{ .Params.first_name }} {{ .Params.last_name }}, électricien certifié à {{ .Params.address.addressLocality }}{{ if .Params.address.postalCode }} ({{ .Params.address.postalCode }}){{ end }} - {{ .Params.years_experience }} ans d'expérience en {{ .Params.specialty }}"
                  class="w-full h-full object-cover"
                  width="400"
                  height="300"
                  loading="eager"
                />
              </picture>

              {{/* Availability Badge */}}
              {{ if .Params.available_24_7 }}
              <div class="absolute top-4 right-4 bg-red-600 text-white px-3 py-1 rounded-full text-sm font-semibold shadow-lg">
                24/7
              </div>
              {{ end }}
            </div>
          </div>

          {{/* Info Column */}}
          <div class="md:w-3/5 p-6 md:p-8 lg:p-10">

            {{/* Badge */}}
            <div class="mb-4">
              <span class="inline-block px-3 py-1 bg-{{ .Params.badge_color }}-600 text-white text-sm font-semibold rounded-full">
                {{ .Params.specialty_badge }}
              </span>
            </div>

            {{/* Name */}}
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-2">
              {{ .Params.first_name }} {{ .Params.last_name }}
            </h1>

            {{/* Specialty */}}
            <p class="text-xl md:text-2xl text-blue-600 font-medium mb-4">
              {{ .Params.specialty }}
            </p>

            {{/* Rating & Experience */}}
            <div class="flex flex-wrap items-center gap-4 mb-6 text-sm md:text-base">
              {{/* Stars */}}
              <div class="flex items-center">
                {{ range seq 5 }}
                  <svg class="w-5 h-5 {{ if le . $.Params.rating }}text-yellow-400{{ else }}text-gray-300{{ end }}" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                  </svg>
                {{ end }}
                <span class="ml-2 font-semibold text-gray-900">{{ .Params.rating }}</span>
                <span class="text-gray-600 ml-1">({{ .Params.review_count }} avis)</span>
              </div>

              {{/* Experience */}}
              <div class="flex items-center text-gray-700">
                <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
                {{ .Params.years_experience }} ans d'expérience
              </div>

              {{/* Price Range */}}
              <div class="flex items-center text-gray-700">
                <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                {{ .Params.price_range | default "€€" }}
              </div>
            </div>

            {{/* Bio */}}
            <p class="text-gray-700 mb-6 leading-relaxed">
              {{ .Params.bio }}
            </p>

            {{/* CTA Buttons */}}
            <div class="flex flex-col sm:flex-row gap-3">
              <a
                href="tel:{{ .Params.phone_href }}"
                class="inline-flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition shadow-lg hover:shadow-xl"
              >
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"/>
                </svg>
                {{ .Params.phone }}
              </a>

              <a
                href="#services"
                class="inline-flex items-center justify-center gap-2 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 px-6 rounded-lg transition"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                </svg>
                Voir les services
              </a>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

{{/* Services Section */}}
<section id="services" class="py-12 md:py-16 bg-white">
  <div class="container mx-auto px-4">
    <div class="max-w-5xl mx-auto">
      <h2 class="text-2xl md:text-3xl font-bold mb-8 text-center">Services proposés</h2>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
        {{ range .Params.services }}
        <div class="flex items-center gap-3 p-4 bg-blue-50 rounded-lg border border-blue-100 hover:border-blue-300 hover:shadow-md transition">
          <svg class="w-6 h-6 text-blue-600 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"/>
          </svg>
          <span class="font-medium text-gray-800">{{ . }}</span>
        </div>
        {{ end }}
      </div>
    </div>
  </div>
</section>

{{/* FAQ Section */}}
<section class="py-12 md:py-16 bg-white border-t border-gray-100">
  <div class="container mx-auto px-4">
    <div class="max-w-5xl mx-auto">
      <h2 class="text-2xl md:text-3xl font-bold mb-8 text-center">Questions fréquentes</h2>

      <div class="space-y-4">
        {{/* Question 1: Coverage Area */}}
        <details class="bg-blue-50 rounded-lg p-6 border border-blue-100 hover:border-blue-300 transition group">
          <summary class="font-semibold text-lg text-gray-900 cursor-pointer flex items-center justify-between">
            <span>Quelle est la zone d'intervention de {{ .Params.first_name }} {{ .Params.last_name }} ?</span>
            <svg class="w-5 h-5 text-blue-600 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="mt-4 text-gray-700 leading-relaxed">
            {{ .Params.first_name }} {{ .Params.last_name }} intervient principalement à {{ .Params.address.addressLocality }}{{ if .Params.address.postalCode }} ({{ .Params.address.postalCode }}){{ end }} et dans toute l'Île-de-France{{ if .Params.coverage_zones }}, notamment dans les départements {{ delimit .Params.coverage_zones ", " }}{{ end }}.
          </div>
        </details>

        {{/* Question 2: Experience */}}
        <details class="bg-blue-50 rounded-lg p-6 border border-blue-100 hover:border-blue-300 transition group">
          <summary class="font-semibold text-lg text-gray-900 cursor-pointer flex items-center justify-between">
            <span>Quelle est l'expérience de cet électricien ?</span>
            <svg class="w-5 h-5 text-blue-600 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="mt-4 text-gray-700 leading-relaxed">
            Avec {{ .Params.years_experience }} ans d'expérience dans le domaine de l'électricité, {{ .Params.first_name }} {{ .Params.last_name }} est spécialisé en {{ .Params.specialty | lower }}. {{ .Params.review_count | default 0 }} clients ont évalué ses services avec une note moyenne de {{ .Params.rating }}/5.
          </div>
        </details>

        {{/* Question 3: Services */}}
        <details class="bg-blue-50 rounded-lg p-6 border border-blue-100 hover:border-blue-300 transition group">
          <summary class="font-semibold text-lg text-gray-900 cursor-pointer flex items-center justify-between">
            <span>Quels services propose cet électricien ?</span>
            <svg class="w-5 h-5 text-blue-600 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="mt-4 text-gray-700 leading-relaxed">
            {{ .Params.first_name }} {{ .Params.last_name }} propose les services suivants : {{ delimit .Params.services ", " }}. Chaque intervention est réalisée dans le respect des normes en vigueur.
          </div>
        </details>

        {{/* Question 4: Availability */}}
        <details class="bg-blue-50 rounded-lg p-6 border border-blue-100 hover:border-blue-300 transition group">
          <summary class="font-semibold text-lg text-gray-900 cursor-pointer flex items-center justify-between">
            <span>{{ if .Params.available_24_7 }}Cet électricien est-il disponible 24h/24 ?{{ else }}Quels sont les horaires d'intervention ?{{ end }}</span>
            <svg class="w-5 h-5 text-blue-600 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="mt-4 text-gray-700 leading-relaxed">
            {{ if .Params.available_24_7 }}
            Oui, {{ .Params.first_name }} {{ .Params.last_name }} propose un service d'urgence 24h/24 et 7j/7 pour répondre à tous vos besoins en électricité, même les week-ends et jours fériés.
            {{ else }}
            {{ .Params.first_name }} {{ .Params.last_name }} intervient sur rendez-vous. N'hésitez pas à le contacter pour convenir d'un horaire qui vous convient.
            {{ end }}
          </div>
        </details>

        {{/* Question 5: Pricing */}}
        <details class="bg-blue-50 rounded-lg p-6 border border-blue-100 hover:border-blue-300 transition group">
          <summary class="font-semibold text-lg text-gray-900 cursor-pointer flex items-center justify-between">
            <span>Comment obtenir un devis gratuit ?</span>
            <svg class="w-5 h-5 text-blue-600 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="mt-4 text-gray-700 leading-relaxed">
            Contactez {{ .Params.first_name }} {{ .Params.last_name }} au {{ .Params.phone }} pour obtenir un devis gratuit et sans engagement. Un diagnostic précis vous sera proposé avant toute intervention.
          </div>
        </details>

        {{/* Question 6: Certifications */}}
        <details class="bg-blue-50 rounded-lg p-6 border border-blue-100 hover:border-blue-300 transition group">
          <summary class="font-semibold text-lg text-gray-900 cursor-pointer flex items-center justify-between">
            <span>Cet électricien est-il certifié ?</span>
            <svg class="w-5 h-5 text-blue-600 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </summary>
          <div class="mt-4 text-gray-700 leading-relaxed">
            Oui, {{ .Params.first_name }} {{ .Params.last_name }} est un professionnel qualifié membre du réseau ECLAT RAPIDE ELECTRICITE. Toutes les interventions sont garanties et conformes aux normes NF C 15-100.
          </div>
        </details>
      </div>
    </div>
  </div>
</section>

{{/* FAQ Schema */}}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "Quelle est la zone d'intervention de {{ .Params.first_name }} {{ .Params.last_name }} ?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "{{ .Params.first_name }} {{ .Params.last_name }} intervient principalement à {{ .Params.address.addressLocality }}{{ if .Params.address.postalCode }} ({{ .Params.address.postalCode }}){{ end }} et dans toute l'Île-de-France{{ if .Params.coverage_zones }}, notamment dans les départements {{ delimit .Params.coverage_zones ", " }}{{ end }}."
      }
    },
    {
      "@type": "Question",
      "name": "Quelle est l'expérience de cet électricien ?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Avec {{ .Params.years_experience }} ans d'expérience dans le domaine de l'électricité, {{ .Params.first_name }} {{ .Params.last_name }} est spécialisé en {{ .Params.specialty | lower }}. {{ .Params.review_count | default 0 }} clients ont évalué ses services avec une note moyenne de {{ .Params.rating }}/5."
      }
    },
    {
      "@type": "Question",
      "name": "Quels services propose cet électricien ?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "{{ .Params.first_name }} {{ .Params.last_name }} propose les services suivants : {{ delimit .Params.services ", " }}. Chaque intervention est réalisée dans le respect des normes en vigueur."
      }
    },
    {
      "@type": "Question",
      "name": "{{ if .Params.available_24_7 }}Cet électricien est-il disponible 24h/24 ?{{ else }}Quels sont les horaires d'intervention ?{{ end }}",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "{{ if .Params.available_24_7 }}Oui, {{ .Params.first_name }} {{ .Params.last_name }} propose un service d'urgence 24h/24 et 7j/7 pour répondre à tous vos besoins en électricité, même les week-ends et jours fériés.{{ else }}{{ .Params.first_name }} {{ .Params.last_name }} intervient sur rendez-vous. N'hésitez pas à le contacter pour convenir d'un horaire qui vous convient.{{ end }}"
      }
    },
    {
      "@type": "Question",
      "name": "Comment obtenir un devis gratuit ?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Contactez {{ .Params.first_name }} {{ .Params.last_name }} au {{ .Params.phone }} pour obtenir un devis gratuit et sans engagement. Un diagnostic précis vous sera proposé avant toute intervention."
      }
    },
    {
      "@type": "Question",
      "name": "Cet électricien est-il certifié ?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Oui, {{ .Params.first_name }} {{ .Params.last_name }} est un professionnel qualifié membre du réseau ECLAT RAPIDE ELECTRICITE. Toutes les interventions sont garanties et conformes aux normes NF C 15-100."
      }
    }
  ]
}
</script>

{{/* Coverage Area Section */}}
{{ if .Params.address }}
<section class="py-12 md:py-16 bg-gray-50">
  <div class="container mx-auto px-4">
    <div class="max-w-5xl mx-auto">
      <h2 class="text-2xl md:text-3xl font-bold mb-8 text-center">Zone d'intervention</h2>

      <div class="bg-white rounded-xl p-6 md:p-8 shadow-lg">
        <div class="flex items-start gap-4">
          <svg class="w-6 h-6 text-blue-600 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
          </svg>
          <div>
            <p class="text-lg font-semibold text-gray-900 mb-2">
              {{ .Params.address.addressLocality }}{{ if .Params.address.postalCode }}, {{ .Params.address.postalCode }}{{ end }}
            </p>
            <p class="text-gray-600">
              Intervention dans toute l'Île-de-France
              {{ if .Params.coverage_zones }}
              <span class="text-gray-500">(départements {{ delimit .Params.coverage_zones ", " }})</span>
              {{ end }}
            </p>
          </div>
        </div>
      </div>

      {{/* Profile Commune Links - SEO Internal Linking */}}
      {{ $profileSlug := path.Base .File.Dir }}
      {{ $profileCommunes := index .Site.Data.profile_commune_links.by_profile $profileSlug }}

      {{ if gt (len $profileCommunes) 0 }}
      <div class="mt-8 pt-8 border-t border-gray-200">
        <h3 class="text-xl md:text-2xl font-bold text-gray-900 mb-6 text-center">
          Communes desservies
        </h3>
        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3 md:gap-4">
          {{ range $profileCommunes }}
            <a
              href="{{ .url }}"
              rel="related"
              title="{{ .anchor }} - Service professionnel"
              class="group relative bg-white hover:bg-gradient-to-br hover:from-blue-500 hover:to-blue-600 border border-gray-200 hover:border-blue-500 rounded-lg p-4 transition-all duration-200 shadow-sm hover:shadow-md"
            >
              <div class="flex flex-col gap-2">
                {{/* City name */}}
                <div class="font-semibold text-gray-900 group-hover:text-white text-sm line-clamp-2 min-h-[2.5rem]">
                  {{ .anchor }}
                </div>

                {{/* Department badge */}}
                <div class="flex items-center gap-1 text-xs">
                  <span class="inline-flex items-center px-2 py-0.5 rounded bg-gray-100 group-hover:bg-white/20 text-gray-600 group-hover:text-white font-medium">
                    {{ .department }}
                  </span>
                  {{ if .has_video }}
                  <svg class="w-3.5 h-3.5 text-gray-400 group-hover:text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zm12.553 1.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"/>
                  </svg>
                  {{ end }}
                </div>

                {{/* Arrow icon (appears on hover) */}}
                <div class="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity">
                  <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                  </svg>
                </div>
              </div>
            </a>
          {{ end }}
        </div>
      </div>
      {{ end }}

    </div>
  </div>
</section>
{{ end }}

{{/* Final CTA Section */}}
<section class="py-12 md:py-16 bg-blue-600 text-white">
  <div class="container mx-auto px-4 text-center">
    <div class="max-w-3xl mx-auto">
      <h2 class="text-2xl md:text-3xl font-bold mb-4">
        Besoin d'un électricien {{ .Params.available_24_7 }}{{ if .Params.available_24_7 }}24/7{{ end }} ?
      </h2>
      <p class="text-lg mb-8 text-blue-100">
        Contactez {{ .Params.first_name }} {{ .Params.last_name }} pour un devis gratuit
      </p>
      <a
        href="tel:{{ .Params.phone_href }}"
        class="inline-flex items-center gap-2 bg-white text-blue-600 hover:bg-gray-100 font-bold py-4 px-8 rounded-lg transition shadow-xl text-lg"
      >
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
          <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"/>
        </svg>
        {{ .Params.phone }}
      </a>
    </div>
  </div>
</section>

{{/* Include Profile Schema */}}
{{ partial "schema-profile.html" . }}

{{ end }}
